<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" type="text/css" href="./css/MALCstylesheet.css">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css">
    <!--    <link rel="stylesheet" href="css/bootstrap.min.css">-->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>




    <title>MALC - Comparing Result</title>
    <link rel="icon" type="image/ico" href="./imgs/malC.png">
    <style>
        body {
            background-image: url("./imgs/wallpaperflare.com_wallpaper (3).jpg");

        };
          .btn-dark{
        }
        .active{
            background-color:dimgrey !important;
        }
        
    </style>

</head>

<body>

    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div>
            <a class="navbar-brand" href="#">
                <img src="./imgs/malC.png" width="30" height="30" class="d-inline-block align-top" alt=""> MAL Comparator
            </a>
        </div>
        <div>
            <ul class="navbar-nav">

                <li class="nav-item">
                    <a class="nav-link" href="#">Statistics</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Show Comparison</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">New Comparison</a>
                </li>
            </ul>

        </div>
    </nav>



    <div class="container">
        <br>
        <div class="alert alert-dark" role="alert" id="compare_id">
            Comparison ID : <%=compid%>
        </div>
        <div class="btn-group btn-group-toggle btn-group-justified btn-group-lg Main-buttons" data-toggle="buttons">
             <label id="Any" class="btn btn-dark mr-1 active rounded">
                <input type="radio" checked autocomplete="off">Any User
            </label>
            <label id="Mutual" class="btn btn-dark mr-1  rounded">
                <input type="radio" checked autocomplete="off">Mutual
            </label>
            <label id="User1" class="btn btn-dark mr-1 rounded">
                <input type="radio" autocomplete="off" name="User1"><span id="user1name">User1</span>
            </label>
            <label id="User2" class="btn btn-dark mr-1 rounded">
                <input type="radio" autocomplete="off" name="User2"><span id="user2name">User2</span>
            </label>
        </div>
        <div class="btn-group btn-group-toggle btn-group-justified btn-group-lg Main-buttons" data-toggle="buttons">
            <label id="All" class="btn btn-dark mr-1 active rounded">
                <input type="radio" checked autocomplete="off">ALL
            </label>
            <label id="Completed" class="btn btn-dark mr-1 rounded">
                <input type="radio" autocomplete="off">Completed
            </label>
            <label id="Watching" class="btn btn-dark mr-1 rounded">
                <input type="radio" autocomplete="off">Watching
            </label>
            <label id="Dropped" class="btn btn-dark mr-1 rounded">
                <input type="radio" autocomplete="off">Dropped
            </label>
            <label id="Ptw" class="btn btn-dark mr-1 rounded">
                <input type="radio" autocomplete="off">Plan to Watch
            </label>
            
        </div>
        <div class="btn-group btn-group-toggle btn-group-justified btn-group-lg Main-buttons" data-toggle="buttons">
            <label id="OnlySelectedUser" class="btn btn-dark mr-1 active rounded">
                <input type="checkbox" checked autocomplete="off">Only Selected User
            </label>
        </div>
        <div class="btn-group  btn-group-justified btn-group-lg Main-buttons">
            <button class="btn btn-dark mr-1 rounded" onClick="update()">Apply Filter </button>
        </div>
    </div>



    <div class="container-fluid" style="width: 80%">
        <div class="row" id="cardlist">

            <!--
            <div class="card" id="card1">
                <img src="./imgs/wallpaperflare.com_wallpaper (3).jpg" id="anime_poster" class="card-img-top" alt="...">
                <div class="card-body">
                    <h4 class="card-title" id="anime_name"><a href="${testinglist[id].url}">Anime Name</a></h4>
                    <h4 class="card-title" id="anime_episode">Episodes# </h4>

                    <hr class="my-2">
                    <table>
                        <tr id="anime_table">
                            <td id="anime_table">
                                <h5 id="anime_user"><img id="anime_status" src="./imgs/mention.png" height="20"> @user1
                                </h5>
                            </td>

                            <td id="anime_table">
                                <h5 id="anime_user"><img id="anime_status" src="./imgs/mention.png" height="20"> @user1
                                </h5>
                            </td>
                        </tr>
                        <tr id="anime_table">
                            <td id="anime_table">
                                <h5 id="anime_status"> <img id="anime_status" src="./imgs/status.png" height="20"> Status</h5>
                            </td>
                            <td id="anime_table">
                                <h5 id="anime_status"> <img id="anime_status" src="./imgs/status.png" height="20"> Status</h5>
                            </td>
                        </tr>
                        <tr id="anime_table">
                            <td id="anime_table">
                                <h5 id="anime_status"> <img id="anime_status" src="./imgs/score.png" height="20"> score
                                </h5>
                            </td>
                            <td id="anime_table">
                                <h5 id="anime_status"> <img id="anime_status" src="./imgs/score.png" height="20"> score
                                </h5>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
-->


        </div>
    </div>


</body>

<script>
    console.log("hi");
    var testinglist;

    function update() {
        var mutual = $("#Mutual").hasClass("active")
        var comp = $("#Completed").hasClass("active")
        var watch = $("#Watching").hasClass("active")
        var drop = $("#Dropped").hasClass("active")
        var ptw = $("#Ptw").hasClass("active")
        var user1 = $("#User1").hasClass("active")
        var user2 = $("#User2").hasClass("active")
        var all = $("#All").hasClass("active")
        var any = $("#Any").hasClass("active")

        console.log(mutual)
        console.log(comp)
        console.log(watch)
        console.log(drop)
        console.log(user1)
        console.log(ptw)
        console.log(user2)
        console.log("Updating")
        testinglist = compared_list.slice()
        var testinglist2;
        console.log(testinglist)

        var id = 0
        
        if (any) {
        if (comp) {
            for (var i = testinglist.length-1; i >= 0; i--) {
                console.log(i)
                if (!(testinglist[i].status1.includes("Completed")) && !(testinglist[i].status2.includes("Completed"))) {
                    testinglist.splice(i, 1)
                }
            }
        }
        if (watch) {
            for (var i = testinglist.length-1; i >= 0; i--) {
                if (!(testinglist[i].status1.includes( "Watching"))&&!(testinglist[i].status2.includes( "Watching"))) {
                    testinglist.splice(i, 1)
                }
            }
        }
        if (drop) {
            for (var i = testinglist.length-1; i >= 0; i--) {
                if (!(testinglist[i].status1.includes(  "Dropped")) && !(testinglist[i].status2.includes(  "Dropped"))) {
                    testinglist.splice(i, 1)
                }
            }
        }
        if (ptw) {
            for (var i = testinglist.length-1; i >= 0; i--) {
                if (!(testinglist[i].status1.includes(  "Plan to Watch")) && !(testinglist[i].status2.includes(  "Plan to Watch"))) {
                    testinglist.splice(i, 1)
                }
            }
        }
            
        }
        
        if (mutual) {
            for (var i = testinglist.length - 1; i >= 0; i--) {
                if (!testinglist[i].Mutual) {
                    testinglist.splice(i, 1)
                }
            }
        if (comp) {
            for (var i = testinglist.length-1; i >= 0; i--) {
                console.log(i)
                if (!(testinglist[i].status1.includes("Completed") && testinglist[i].status2.includes("Completed"))) {
                    testinglist.splice(i, 1)
                }
            }
        }
        if (watch) {
            for (var i = testinglist.length-1; i >= 0; i--) {
                if (!(testinglist[i].status1.includes( "Watching")&&testinglist[i].status2.includes( "Watching"))) {
                    testinglist.splice(i, 1)
                }
            }
        }
        if (drop) {
            for (var i = testinglist.length-1; i >= 0; i--) {
                if (!(testinglist[i].status1.includes(  "Dropped") && testinglist[i].status2.includes(  "Dropped"))) {
                    testinglist.splice(i, 1)
                }
            }
        }
        if (ptw) {
            for (var i = testinglist.length-1; i >= 0; i--) {
                if (!(testinglist[i].status1.includes(  "Plan to Watch") && testinglist[i].status2.includes(  "Plan to Watch"))) {
                    testinglist.splice(i, 1)
                }
            }
        }
            
        }
        
 
        if (user1) {
            if(all){
                for (var i = testinglist.length-1; i >= 0; i--) {
                    if (testinglist[i].status1 == "Not Listed") {
                    testinglist.splice(i, 1)
                }
                }
            }
            if (comp) {
            for (var i = testinglist.length-1; i >= 0; i--) {
                console.log(i)
                if (!testinglist[i].status1.includes("Completed")) {
                    testinglist.splice(i, 1)
                }
            }
        }
        if (watch) {
            for (var i = testinglist.length-1; i >= 0; i--) {
                if (!testinglist[i].status1.includes( "Watching")) {
                    testinglist.splice(i, 1)
                }
            }
        }
        if (drop) {
            for (var i = testinglist.length-1; i >= 0; i--) {
                if (!testinglist[i].status1.includes(  "Dropped")) {
                    testinglist.splice(i, 1)
                }
            }
        }
        if (ptw) {
            for (var i = testinglist.length-1; i >= 0; i--) {
                if (!testinglist[i].status1.includes(  "Plan to Watch")) {
                    testinglist.splice(i, 1)
                }
            }
        }

        }
        if (user2) {
            if(all){
                for (var i = testinglist.length-1; i >= 0; i--) {
                    if (testinglist[i].status2 == "Not Listed") {
                    testinglist.splice(i, 1)
                }
                }
            }
            if (comp) {
            for (var i = testinglist.length-1; i >= 0; i--) {
                console.log(i)
                if (!testinglist[i].status2.includes("Completed")) {
                    testinglist.splice(i, 1)
                }
            }
        }
        if (watch) {
            for (var i = testinglist.length-1; i >= 0; i--) {
                if (!testinglist[i].status2.includes( "Watching")) {
                    testinglist.splice(i, 1)
                }
            }
        }
        if (drop) {
            for (var i = testinglist.length-1; i >= 0; i--) {
                if (!testinglist[i].status2.includes(  "Dropped")) {
                    testinglist.splice(i, 1)
                }
            }
        }
        if (ptw) {
            for (var i = testinglist.length-1; i >= 0; i--) {
                if (!testinglist[i].status2.includes(  "Plan to Watch")) {
                    testinglist.splice(i, 1)
                }
            }
        }
        }
                $("#cardlist").empty();

                $("#cardlist").append(`<div class="card" id="card${id}">
                         <a href="${testinglist[id].url}" id="anime_poster" class="card-img-top"><img src=${testinglist[id].Img_url} id="anime_poster" class="card-img-top" alt="..."></a>
                        <div class="card-body">
                            <h4 class="card-title" id="anime_name"><a href="${testinglist[id].url}">${testinglist[id].title}</a></h4>
                            <h4 class="card-title" id="anime_episode">Episodes#${testinglist[id].episodes} </h4>
        
                            <hr class="my-2">
                            <table>
                                <tr id="anime_table">
                                    <td id="anime_table">
                                        <h5 id="anime_user"><img id="anime_status" src="./imgs/mention.png" height="20"> @${users[0]}
                                        </h5>
                                    </td>
        
                                    <td id="anime_table">
                                        <h5 id="anime_user"><img id="anime_status" src="./imgs/mention.png" height="20"> @${users[1]}
                                        </h5>
                                    </td>
                                </tr>
                                <tr id="anime_table">
                                    <td id="anime_table">
                                        <h5 id="anime_status"> <img id="anime_status" src="./imgs/status.png" height="20"> ${testinglist[id].status1}</h5>
                                    </td>
                                    <td id="anime_table">
                                        <h5 id="anime_status"> <img id="anime_status" src="./imgs/status.png" height="20"> ${testinglist[id].status2}</h5>
                                    </td>
                                </tr>
                                <tr id="anime_table">
                                    <td id="anime_table">
                                        <h5 id="anime_status"> <img id="anime_status" src="./imgs/score.png" height="20"> ${testinglist[id].score1}
                                        </h5>
                                    </td>
                                    <td id="anime_table">
                                        <h5 id="anime_status"> <img id="anime_status" src="./imgs/score.png" height="20"> ${testinglist[id].score2}
                                        </h5>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>`);
                    for (var id = 1; id < testinglist.length; id++) {
                     $(`#card${id-1}`).after(`<div class="card" id="card${id}">
                      <a href="${testinglist[id].url}" id="anime_poster" class="card-img-top">   <img src=${testinglist[id].Img_url} id="anime_poster" class="card-img-top" alt="..."></a>
                        <div class="card-body">
                            <h4 class="card-title" id="anime_name"><a href="${testinglist[id].url}">${testinglist[id].title}</a></h4>
                            <h4 class="card-title" id="anime_episode">Episodes#${testinglist[id].episodes} </h4>
        
                            <hr class="my-2">
                            <table>
                                <tr id="anime_table">
                                    <td id="anime_table">
                                        <h5 id="anime_user"><img id="anime_status" src="./imgs/mention.png" height="20"> @${users[0]}
                                        </h5>
                                    </td>
        
                                    <td id="anime_table">
                                        <h5 id="anime_user"><img id="anime_status" src="./imgs/mention.png" height="20"> @${users[1]}
                                        </h5>
                                    </td>
                                </tr>
                                <tr id="anime_table">
                                    <td id="anime_table">
                                        <h5 id="anime_status"> <img id="anime_status" src="./imgs/status.png" height="20"> ${testinglist[id].status1}</h5>
                                    </td>
                                    <td id="anime_table">
                                        <h5 id="anime_status"> <img id="anime_status" src="./imgs/status.png" height="20"> ${testinglist[id].status2}</h5>
                                    </td>
                                </tr>
                                <tr id="anime_table">
                                    <td id="anime_table">
                                        <h5 id="anime_status"> <img id="anime_status" src="./imgs/score.png" height="20"> ${testinglist[id].score1}
                                        </h5>
                                    </td>
                                    <td id="anime_table">
                                        <h5 id="anime_status"> <img id="anime_status" src="./imgs/score.png" height="20"> ${testinglist[id].score2}
                                        </h5>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>`);
                }

    }


//    function loadJSON(callback) {
//
//        var xobj = new XMLHttpRequest();
//        xobj.overrideMimeType("application/json");
//        xobj.open('GET', 'http://127.0.0.1:3001/index2', true); // Replace 'my_data' with the path to your file
//        xobj.onreadystatechange = function() {
//            if (xobj.readyState == 4 && xobj.status == "200") {
//                // Required use of an anonymous callback as .open will NOT return a value but simply returns undefined in asynchronous mode
//                callback(xobj.responseText);
//            }
//        };
//        xobj.send(null);
//    }
    var compared_listinit = <%- JSON.stringify(compared) %>;
    var users = [compared_listinit[0],compared_listinit[1]];
    $("#user1name").text(users[0]);
    $("#user2name").text(users[1]);
     compared_list = compared_listinit[2]
    
        // Parse JSON string into object
        for (var i = 0; i < compared_list.length; i++) {
            if (compared_list[i].status1 == 1) {
                compared_list[i].status1 = '<span style="color: blueviolet"> Watching </span>'
            } else if (compared_list[i].status1 == 2) {
                compared_list[i].status1 = '<span style="color: green"> Completed </span>'

            } else if (compared_list[i].status1 == 3) {
                compared_list[i].status1 = '<span style="color: darkorange"> On-Hold </span>'

            } else if (compared_list[i].status1 == 4) {
                compared_list[i].status1 = '<span style="color: red"> Dropped </span>'

            } else if (compared_list[i].status1 == 6) {
                compared_list[i].status1 = '<span style="color: powderblue"> Plan to Watch </span>'

            }
             if (compared_list[i].status2 == 1) {
                compared_list[i].status2 = '<span style="color: blueviolet"> Watching </span>'
            } else if (compared_list[i].status2 == 2) {
                compared_list[i].status2 = '<span style="color: green"> Completed </span>'

            } else if (compared_list[i].status2 == 3) {
                compared_list[i].status2 = '<span style="color: darkorange"> On-Hold </span>'

            } else if (compared_list[i].status2 == 4) {
                compared_list[i].status2 = '<span style="color: red"> Dropped </span>'

            } else if (compared_list[i].status2 == 6) {
                compared_list[i].status2 = '<span style="color: powderblue"> Plan to Watch </span>'

            }
        }
        // 1 = watching
        // 2= completed
        // 3= on-Hold
        // 4 = dropped
        // 5 = X
        // 6 = plan-to-watch

//        console.log(compared_list)
        testinglist = compared_list
        //      var test = {"animes2":[]}
        //      test.animes2[0] = compared_list.animes[0].title;

        //      console.log(test)

        var id = 0

        $("#cardlist").append(`<div class="card" id="card${id}">
                 <a href="${testinglist[id].url}" id="anime_poster" class="card-img-top"><img src=${testinglist[id].Img_url} href="${testinglist[id].url}" id="anime_poster" class="card-img-top" alt="..."></a>
                <div class="card-body">
                    <h4 class="card-title" id="anime_name"><a href="${testinglist[id].url}">${testinglist[id].title}</a></h4>
                    <h4 class="card-title" id="anime_episode">Episodes#${testinglist[id].episodes} </h4>

                    <hr class="my-2">
                    <table>
                        <tr id="anime_table">
                            <td id="anime_table">
                                <h5 id="anime_user"><img id="anime_status" src="./imgs/mention.png" height="20"> @${users[0]}
                                </h5>
                            </td>

                            <td id="anime_table">
                                <h5 id="anime_user"><img id="anime_status" src="./imgs/mention.png" height="20"> @${users[1]}
                                </h5>
                            </td>
                        </tr>
                        <tr id="anime_table">
                            <td id="anime_table">
                                <h5 id="anime_status"> <img id="anime_status" src="./imgs/status.png" height="20"> ${testinglist[id].status1}</h5>
                            </td>
                            <td id="anime_table">
                                <h5 id="anime_status"> <img id="anime_status" src="./imgs/status.png" height="20"> ${testinglist[id].status2}</h5>
                            </td>
                        </tr>
                        <tr id="anime_table">
                            <td id="anime_table">
                                <h5 id="anime_status"> <img id="anime_status" src="./imgs/score.png" height="20"> ${testinglist[id].score1}
                                </h5>
                            </td>
                            <td id="anime_table">
                                <h5 id="anime_status"> <img id="anime_status" src="./imgs/score.png" height="20"> ${testinglist[id].score2}
                                </h5>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>`);
        for (var id = 1; id < testinglist.length; id++) {
            $(`#card${id-1}`).after(`<div class="card" id="card${id}">
                <a href="${testinglist[id].url}" id="anime_poster" class="card-img-top"> <img src=${testinglist[id].Img_url}  id="anime_poster" class="card-img-top" alt="..."></a>
                <div class="card-body">
                    <h4 class="card-title" id="anime_name"><a href="${testinglist[id].url}">${testinglist[id].title}</a></h4>
                    <h4 class="card-title" id="anime_episode">Episodes#${testinglist[id].episodes} </h4>

                    <hr class="my-2">
                    <table>
                        <tr id="anime_table">
                            <td id="anime_table">
                                <h5 id="anime_user"><img id="anime_status" src="./imgs/mention.png" height="20"> @${users[0]}
                                </h5>
                            </td>

                            <td id="anime_table">
                                <h5 id="anime_user"><img id="anime_status" src="./imgs/mention.png" height="20"> @${users[1]}
                                </h5>
                            </td>
                        </tr>
                        <tr id="anime_table">
                            <td id="anime_table">
                                <h5 id="anime_status"> <img id="anime_status" src="./imgs/status.png" height="20"> ${testinglist[id].status1}</h5>
                            </td>
                            <td id="anime_table">
                                <h5 id="anime_status"> <img id="anime_status" src="./imgs/status.png" height="20"> ${testinglist[id].status2}</h5>
                            </td>
                        </tr>
                        <tr id="anime_table">
                            <td id="anime_table">
                                <h5 id="anime_status"> <img id="anime_status" src="./imgs/score.png" height="20"> ${testinglist[id].score1}
                                </h5>
                            </td>
                            <td id="anime_table">
                                <h5 id="anime_status"> <img id="anime_status" src="./imgs/score.png" height="20"> ${testinglist[id].score2}
                                </h5>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>`);
        }


    //    $("#Mutual").click(function(){	
    //        if(!$("#Mutual").hasClass("active")){
    //            console.log("TRUE")
    //        }else{
    //            console.log("FALSE")
    //        }
    //    })
    //        console.log("heee")});




    // 1 = watching
    // 2= completed
    // 3= on-Hold
    // 4 = dropped
    // 5 = X
    // 6 = plan-to-watch
</script></html>
